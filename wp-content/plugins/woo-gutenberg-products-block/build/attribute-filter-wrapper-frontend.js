(window.webpackWcBlocksJsonp=window.webpackWcBlocksJsonp||[]).push([[15],{109:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l}));var r=n(6);const a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";const l=e.filter(e=>e.attribute===n.taxonomy),s=l.length?l[0]:null;if(!(s&&s.slug&&Array.isArray(s.slug)&&s.slug.includes(a)))return;const c=s.slug.filter(e=>e!==a),i=e.filter(e=>e.attribute!==n.taxonomy);c.length>0&&(s.slug=c.sort(),i.push(s)),t(Object(r.sortBy)(i,"attribute"))},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"in";if(!n||!n.taxonomy)return[];const s=e.filter(e=>e.attribute!==n.taxonomy);return 0===a.length?t(s):(s.push({attribute:n.taxonomy,operator:l,slug:a.map(e=>{let{slug:t}=e;return t}).sort()}),t(Object(r.sortBy)(s,"attribute"))),s}},121:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s}));var r=n(2);const a=Object(r.getSetting)("attributes",[]).reduce((e,t)=>{const n=(r=t)&&r.attribute_name?{id:parseInt(r.attribute_id,10),name:r.attribute_name,taxonomy:"pa_"+r.attribute_name,label:r.attribute_label}:null;var r;return n&&n.id&&e.push(n),e},[]),l=e=>{if(e)return a.find(t=>t.id===e)},s=e=>{if(e)return a.find(t=>t.taxonomy===e)}},126:function(e){e.exports=JSON.parse('{"name":"woocommerce/attribute-filter","version":"1.0.0","title":"Filter by Attribute Controls","description":"Enable customers to filter the product grid by selecting one or more attributes, such as color.","category":"woocommerce","keywords":["WooCommerce"],"supports":{"html":false,"color":{"text":true,"background":false},"inserter":false,"lock":false},"example":{"attributes":{"isPreview":true}},"attributes":{"className":{"type":"string","default":""},"attributeId":{"type":"number","default":0},"showCounts":{"type":"boolean","default":true},"queryType":{"type":"string","default":"or"},"headingLevel":{"type":"number","default":3},"displayStyle":{"type":"string","default":"list"},"showFilterButton":{"type":"boolean","default":false},"selectType":{"type":"string","default":"multiple"},"isPreview":{"type":"boolean","default":false}},"textdomain":"woo-gutenberg-products-block","apiVersion":2,"$schema":"https://schemas.wp.org/trunk/block.json"}')},156:function(e,t,n){"use strict";var r=n(0),a=n(1),l=n(148),s=n(29),c=n(59),i=n(31),o=n(58),u=n(137),b=n(60),d=n(66),m=n(67),p=n(13),f=n.n(p),g=n(30),j=n(213),O=n(2),y=n(14),h=n(71),v=n(22),w=n(19),_=n(218),E=n(73),k=n(152),C=n(70),x=n(6),N=n(91),A=n(65),L=n(7),S=n.n(L),T=n(121),F=n(109);const I=[{value:"preview-1",formattedValue:"preview-1",name:"Blue",label:Object(r.createElement)(b.a,{name:"Blue",count:3}),textLabel:"Blue (3)"},{value:"preview-2",formattedValue:"preview-2",name:"Green",label:Object(r.createElement)(b.a,{name:"Green",count:3}),textLabel:"Green (3)"},{value:"preview-3",formattedValue:"preview-3",name:"Red",label:Object(r.createElement)(b.a,{name:"Red",count:2}),textLabel:"Red (2)"}],B={id:0,name:"preview",taxonomy:"preview",label:"Preview"};n(217);var q=n(49),D=n(92),P=e=>{let{isLoading:t=!1,options:n,checked:a,onChange:l}=e;return t?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("span",{className:"is-loading"}),Object(r.createElement)("span",{className:"is-loading"})):Object(r.createElement)(D.a,{className:"wc-block-attribute-filter-list",options:n,checked:a,onChange:l,isLoading:t,isDisabled:t})},R=n(43);t.a=e=>{let{attributes:t,isEditor:n=!1}=e;const p=Object(O.getSettingWithCoercion)("has_filterable_products",!1,h.a),L=Object(O.getSettingWithCoercion)("is_rendering_php_template",!1,h.a),D=Object(O.getSettingWithCoercion)("page_url",window.location.href,v.a),V=n?[]:Object(O.getSettingWithCoercion)("product_ids",[],Array.isArray),[M,W]=Object(r.useState)(!1),$=t.isPreview&&!t.attributeId?B:Object(T.a)(t.attributeId),Q=Object(r.useMemo)(()=>Object(q.e)($),[$]),[U,G]=Object(r.useState)(Q),[J,z]=Object(r.useState)(Object(q.d)()),[H,Z]=Object(r.useState)(t.isPreview&&!t.attributeId?I:[]),K=Object(l.a)(t),[X]=Object(i.a)(),[Y,ee]=Object(i.b)("attributes",[]),{results:te,isLoading:ne}=Object(o.a)({namespace:"/wc/store/v1",resourceName:"products/attributes/terms",resourceValues:[(null==$?void 0:$.id)||0],shouldSelect:t.attributeId>0,isEditor:n}),re="dropdown"!==t.displayStyle&&"and"===t.queryType,{results:ae,isLoading:le}=Object(u.a)({queryAttribute:{taxonomy:(null==$?void 0:$.taxonomy)||"",queryType:t.queryType},queryState:{...X,attributes:re?X.attributes:null},productIds:V,isEditor:n}),se=Object(r.useCallback)(e=>Object(w.b)(ae,"attribute_counts")&&Array.isArray(ae.attribute_counts)?ae.attribute_counts.find(t=>{let{term:n}=t;return n===e}):null,[ae]);Object(r.useEffect)(()=>{if(ne||le)return;if(!Array.isArray(te))return;const e=te.map(e=>{const n=se(e.id);if(!(n||U.includes(e.slug)||(a=e.slug,null!=X&&X.attributes&&X.attributes.some(e=>{let{attribute:t,slug:n=[]}=e;return t===(null==$?void 0:$.taxonomy)&&n.includes(a)}))))return null;var a;const l=n?n.count:0;return{formattedValue:Object(q.c)(e.slug),value:e.slug,name:Object(g.decodeEntities)(e.name),label:Object(r.createElement)(b.a,{name:Object(g.decodeEntities)(e.name),count:t.showCounts?l:null}),textLabel:t.showCounts?`${Object(g.decodeEntities)(e.name)} (${l})`:Object(g.decodeEntities)(e.name)}}).filter(e=>!!e);Z(e),z(Object(q.d)())},[null==$?void 0:$.taxonomy,te,ne,t.showCounts,le,se,U,X.attributes]);const ce=Object(r.useCallback)(e=>Array.isArray(te)?te.reduce((t,n)=>(e.includes(n.slug)&&t.push(n),t),[]):[],[te]),ie=Object(r.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=e.map(e=>({...e,slug:e.slug.map(e=>decodeURIComponent(e))})),t){if(null==$||!$.taxonomy)return;const t=Object.keys(Object(y.getQueryArgs)(window.location.href)),n=Object(q.h)($.taxonomy),r=t.reduce((e,t)=>t.includes(C.b+n)||t.includes(C.a+n)?Object(y.removeQueryArgs)(e,t):e,window.location.href),a=Object(q.b)(r,e);Object(C.c)(a)}else{const t=Object(q.b)(D,e),n=Object(y.getQueryArgs)(window.location.href),r=Object(y.getQueryArgs)(t);Object(q.f)(n,r)||Object(C.c)(t)}}),[D,null==$?void 0:$.taxonomy]),oe=e=>{const n=Object(F.b)(Y,ee,$,ce(e),"or"===t.queryType?"in":"and");ie(n,0===e.length)},ue=Object(r.useCallback)((function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n||(G(e),!r&&t.showFilterButton||Object(F.b)(Y,ee,$,ce(e),"or"===t.queryType?"in":"and"))}),[n,G,Y,ee,$,ce,t.queryType,t.showFilterButton]),be=Object(r.useMemo)(()=>Object(_.a)(Y)?Y.filter(e=>{let{attribute:t}=e;return t===(null==$?void 0:$.taxonomy)}).flatMap(e=>{let{slug:t}=e;return t}):[],[Y,null==$?void 0:$.taxonomy]),de=Object(s.a)(be),me=Object(c.a)(de);Object(r.useEffect)(()=>{!me||f()(me,de)||f()(U,de)||ue(de)},[U,de,me,ue]);const pe="single"!==t.selectType,fe=Object(r.useCallback)(e=>{const t=U.includes(e);let n;pe?(n=U.filter(t=>t!==e),t||(n.push(e),n.sort())):n=t?[]:[e],ue(n)},[U,pe,ue]);Object(r.useEffect)(()=>{$&&!t.showFilterButton&&(Object(q.a)({currentCheckedFilters:U,hasSetFilterDefaultsFromUrl:M})?ie(Y,!0):ie(Y,!1))},[M,ie,Y,$,U,t.showFilterButton]),Object(r.useEffect)(()=>{if(!M&&!ne)return Q.length>0?(W(!0),void ue(Q,!0)):void(L||W(!0))},[$,M,ne,ue,Q,L]);const ge=Object(R.b)();if(!p)return ge(!1),null;if(!$)return n?Object(r.createElement)(j.a,{status:"warning",isDismissible:!1},Object(r.createElement)("p",null,Object(a.__)("Please select an attribute to use this filter!","woo-gutenberg-products-block"))):(ge(!1),null);if(0===H.length&&!ne&&n)return Object(r.createElement)(j.a,{status:"warning",isDismissible:!1},Object(r.createElement)("p",null,Object(a.__)("There are no products with the selected attributes.","woo-gutenberg-products-block")));const je="h"+t.headingLevel,Oe=!t.isPreview&&ne,ye=!t.isPreview&&le,he=(Oe||ye)&&0===H.length;if(!he&&0===H.length)return ge(!1),null;const ve=Object(r.createElement)(je,{className:"wc-block-attribute-filter__title"},t.heading),we=he?Object(r.createElement)(A.a,null,ve):ve;return ge(!0),Object(r.createElement)(r.Fragment,null,!n&&t.heading&&we,Object(r.createElement)("div",{className:S()("wc-block-attribute-filter","style-"+t.displayStyle)},"dropdown"===t.displayStyle?Object(r.createElement)(r.Fragment,null,Object(r.createElement)(N.a,{key:J,className:S()(K.className,{"single-selection":!pe,"is-loading":he}),style:{...K.style,borderStyle:"none"},suggestions:H.filter(e=>!U.includes(e.value)).map(e=>e.formattedValue),disabled:he,placeholder:Object(a.sprintf)(
/* translators: %s attribute name. */
Object(a.__)("Select %s","woo-gutenberg-products-block"),$.label),onChange:e=>{!pe&&e.length>1&&(e=[e[e.length-1]]),e=e.map(e=>{const t=H.find(t=>t.formattedValue===e);return t?t.value:e});const t=Object(x.difference)(e,U);if(1===t.length)return fe(t[0]);const n=Object(x.difference)(U,e);1===n.length&&fe(n[0])},value:U,displayTransform:e=>{const t=H.find(t=>[t.value,t.formattedValue].includes(e));return t?t.textLabel:e},saveTransform:q.c,messages:{added:Object(a.sprintf)(
/* translators: %s is the attribute label. */
Object(a.__)("%s filter added.","woo-gutenberg-products-block"),$.label),removed:Object(a.sprintf)(
/* translators: %s is the attribute label. */
Object(a.__)("%s filter removed.","woo-gutenberg-products-block"),$.label),remove:Object(a.sprintf)(
/* translators: %s is the attribute label. */
Object(a.__)("Remove %s filter.","woo-gutenberg-products-block"),$.label.toLocaleLowerCase()),__experimentalInvalid:Object(a.sprintf)(
/* translators: %s is the attribute label. */
Object(a.__)("Invalid %s filter.","woo-gutenberg-products-block"),$.label.toLocaleLowerCase())}}),pe&&Object(r.createElement)(E.a,{icon:k.a,size:30})):Object(r.createElement)(P,{options:H,checked:U,onChange:fe,isLoading:he,isDisabled:he})),Object(r.createElement)("div",{className:"wc-block-attribute-filter__actions"},U.length>0&&!he&&Object(r.createElement)(d.a,{onClick:()=>{G([]),z(Object(q.d)()),M&&oe([])},screenReaderLabel:Object(a.__)("Reset attribute filter","woo-gutenberg-products-block")}),t.showFilterButton&&Object(r.createElement)(m.a,{className:"wc-block-attribute-filter__button",isLoading:he,disabled:(()=>{if(Oe||ye)return!0;const e=Object(q.e)($);return e.length===U.length&&U.every(t=>e.includes(t))})(),onClick:()=>oe(U)})))}},213:function(e,t,n){"use strict";var r=n(0),a=n(6),l=n(7),s=n.n(l),c=n(1),i=n(26),o=n(134),u=n(62);function b(e){switch(e){case"success":case"warning":case"info":return"polite";case"error":default:return"assertive"}}t.a=function({className:e,status:t="info",children:n,spokenMessage:l=n,onRemove:d=a.noop,isDismissible:m=!0,actions:p=[],politeness:f=b(t),__unstableHTML:g,onDismiss:j=a.noop}){!function(e,t){const n="string"==typeof e?e:Object(r.renderToString)(e);Object(r.useEffect)(()=>{n&&Object(i.speak)(n,t)},[n,t])}(l,f);const O=s()(e,"components-notice","is-"+t,{"is-dismissible":m});return g&&(n=Object(r.createElement)(r.RawHTML,null,n)),Object(r.createElement)("div",{className:O},Object(r.createElement)("div",{className:"components-notice__content"},n,Object(r.createElement)("div",{className:"components-notice__actions"},p.map(({className:e,label:t,isPrimary:n,variant:a,noDefaultClasses:l=!1,onClick:c,url:i},o)=>{let b=a;return"primary"===a||l||(b=i?"link":"secondary"),void 0===b&&n&&(b="primary"),Object(r.createElement)(u.a,{key:o,href:i,variant:b,onClick:i?void 0:c,className:s()("components-notice__action",e)},t)}))),m&&Object(r.createElement)(u.a,{className:"components-notice__dismiss",icon:o.a,label:Object(c.__)("Dismiss this notice"),onClick:e=>{var t;null==e||null===(t=e.preventDefault)||void 0===t||t.call(e),j(),d()},showTooltip:!1}))}},217:function(e,t){},218:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c}));var r=n(19);const a=e=>Object(r.b)(e,"count")&&Object(r.b)(e,"description")&&Object(r.b)(e,"id")&&Object(r.b)(e,"name")&&Object(r.b)(e,"parent")&&Object(r.b)(e,"slug")&&"number"==typeof e.count&&"string"==typeof e.description&&"number"==typeof e.id&&"string"==typeof e.name&&"number"==typeof e.parent&&"string"==typeof e.slug,l=e=>Array.isArray(e)&&e.every(a),s=e=>Object(r.b)(e,"attribute")&&Object(r.b)(e,"operator")&&Object(r.b)(e,"slug")&&"string"==typeof e.attribute&&"string"==typeof e.operator&&Array.isArray(e.slug)&&e.slug.every(e=>"string"==typeof e),c=e=>Array.isArray(e)&&e.every(s)},277:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(61),a=n(112),l=n(19),s=n(113);const c=e=>{if(!Object(a.a)())return{className:"",style:{}};const t=Object(l.a)(e)?e:{},n=Object(s.a)(t.style);return Object(r.__experimentalUseColorProps)({...t,style:n})}},441:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(277),l=n(22),s=n(156),c=n(49);t.default=e=>{const t=Object(a.a)(e);return Object(r.createElement)("div",{className:Object(l.a)(e.className)?e.className:"",style:{...t.style}},Object(r.createElement)(s.a,{isEditor:!1,attributes:Object(c.g)(e)}))}},49:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"g",(function(){return p}));var r=n(14),a=n(70),l=n(22),s=n(126);function c(){return Math.floor(Math.random()*Date.now())}const i=e=>e.replace("pa_",""),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n={};t.forEach(e=>{const{attribute:t,slug:r,operator:l}=e,s=i(t),c=r.join(","),o=`${a.b}${s}`,u="in"===l?"or":"and";n[`${a.a}${s}`]=c,n[o]=u});const l=Object(r.removeQueryArgs)(e,...Object.keys(n));return Object(r.addQueryArgs)(l,n)},u=e=>{let{currentCheckedFilters:t,hasSetFilterDefaultsFromUrl:n}=e;return n&&0===t.length},b=e=>{if(e){const t=Object(a.d)("filter_"+e.name);return("string"==typeof t?t.split(","):[]).map(e=>encodeURIComponent(e).toLowerCase())}return[]},d=(e,t)=>{const n=Object.entries(t).reduce((e,t)=>{let[n,r]=t;return n.includes("query_type")?e:{...e,[n]:r}},{});return Object.entries(n).reduce((t,n)=>{let[r,a]=n;return e[r]===a&&t},!0)},m=e=>e.trim().replace(/\s/g,"-").replace(/_/g,"-").replace(/-+/g,"-").replace(/[^a-zA-Z0-9-]/g,""),p=e=>({className:Object(l.a)(null==e?void 0:e.className)?e.className:"",attributeId:parseInt(Object(l.a)(null==e?void 0:e.attributeId)?e.attributeId:"0",10),showCounts:"false"!==(null==e?void 0:e.showCounts),queryType:Object(l.a)(null==e?void 0:e.queryType)&&e.queryType||s.attributes.queryType.default,heading:Object(l.a)(null==e?void 0:e.heading)?e.heading:"",headingLevel:Object(l.a)(null==e?void 0:e.headingLevel)&&parseInt(e.headingLevel,10)||s.attributes.headingLevel.default,displayStyle:Object(l.a)(null==e?void 0:e.displayStyle)&&e.displayStyle||s.attributes.displayStyle.default,showFilterButton:"true"===(null==e?void 0:e.showFilterButton),selectType:Object(l.a)(null==e?void 0:e.selectType)&&e.selectType||s.attributes.selectType.default,isPreview:!1})}}]);